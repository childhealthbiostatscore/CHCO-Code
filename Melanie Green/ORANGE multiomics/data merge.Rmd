---
title: "ORANGE multiomics data merge"
author: "Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r, include=FALSE}
library(readxl)
library(dplyr)

knitr::opts_chunk$set(echo = FALSE,warning = FALSE)

```

```{r, include=FALSE}
# clinical data
clinical <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Clinical Data - Targeted.xlsx")

# plasma metabolomics - amino acids
plasma_aa <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Plasma Metabolomics - Amino Acid Absolute Report.xlsx")
colnames(plasma_aa)[1] <- "ID"
alldata <- merge(clinical, plasma_aa, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# plasma metabolomics - carnitine
plasma_carnitine <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Plasma Metabolomics - Carnitine Absolute Report.xlsx")
colnames(plasma_carnitine)[1] <- "ID"
alldata <- merge(alldata, plasma_carnitine, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# plasma metabolomics - lipids absolute
plasma_lipids_abs <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Plasma Metabolomics - Lipid Absolute Report.xlsx")
colnames(plasma_lipids_abs)[1] <- "ID"
alldata <- merge(alldata, plasma_lipids_abs, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# plasma metabolomics - lipids global
plasma_lipids_global <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Plasma Metabolomics - Lipid Global Report.xlsx")
colnames(plasma_lipids_global)[1] <- "ID"
alldata <- merge(alldata, plasma_lipids_global, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# plasma metabolomics - semi-targeted
plasma_semitargeted_metab <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Plasma Metabolomics - Semi-Targeted Report.xlsx")
colnames(plasma_carnitine)[1] <- "ID"
alldata <- merge(alldata, plasma_carnitine, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool lipidomics normalized
stool_lipids_norm <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Metabolomics with Lipidomics - Normalized.xlsx")
colnames(stool_lipids_norm)[1] <- "ID"
alldata <- merge(alldata, stool_lipids_norm, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool microbiome alpha diversity
stool_microbiome_alpha <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Microbiome - Alpha Diversity.xlsx")
colnames(stool_microbiome_alpha)[1] <- "ID"
alldata <- merge(alldata, stool_microbiome_alpha, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool microbiome family
stool_microbiome_family <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Microbiome - Family.xlsx")
colnames(stool_microbiome_family)[1] <- "ID"
alldata <- merge(alldata, stool_microbiome_family, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool microbiome genus
stool_microbiome_genus <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Microbiome - Genus.xlsx")
colnames(stool_microbiome_genus)[1] <- "ID"
alldata <- merge(alldata, stool_microbiome_genus, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool microbiome order
stool_microbiome_order <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Microbiome - Order.xlsx")
colnames(stool_microbiome_order)[1] <- "ID"
alldata <- merge(alldata, stool_microbiome_order, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# stool microbiome phyla
stool_microbiome_phyla <- read_xlsx("/Volumes/Peds Endo/Melanie Green/ORANGE/Data raw/ORANGE Multiomics for LP 3.18.2023/ORANGE Stool Microbiome - Phyla.xlsx")
colnames(stool_microbiome_phyla)[1] <- "ID"
alldata <- merge(alldata, stool_microbiome_phyla, by=c("ID","Treatment Arm PLA = 0, EAA=1"))

# write dataset
write.csv(alldata, "/Volumes/Peds Endo/Melanie Green/ORANGE/Data clean/merged multiomics data.csv")
```


