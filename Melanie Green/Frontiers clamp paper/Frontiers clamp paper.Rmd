---
title: "Adipose insulin sensitivity in adolescents with extreme insulin resistance"
author: "Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:   
  html_document:
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 3
    toc_float: yes
---

```{r setup, include=FALSE}
library(tableone)
library(knitr)
library(dplyr)
library(ggplot2)
library(hrbrthemes)

knitr::opts_chunk$set(echo = FALSE,warning = FALSE)

data <- read.csv("E:/Melanie Green/Frontiers clamp methods review paper/Data raw/Data template for paper_MelanieLaura.csv",
                 na.strings = c("NA",".",""," ","#DIV/0!"))
data$Age.diabetes.onset <- NULL
data$BMI.category <- NULL
data$Sex <- as.factor(data$Sex)
data$bmi_cat <- ifelse(is.na(data$BMIp),NA,
                       ifelse(data$BMIp<85,"<85th %ile",
                              ifelse(data$BMIp>=85 & data$BMIp<95,"85th - <95th %ile",">=95th %ile")))
data$bmi_twocat <- ifelse(is.na(data$bmi_cat),NA,
                          ifelse(data$bmi_cat=="<85th %ile","Lean","Overweight/Obese"))

# who should be included in analysis? everyone or is there a minimum amount of data?
data <- data[!data$StudyID %in% c("827-042","827-111"),]

# categorize overnight glucose
data$Mean.Glucose.Basal.cat <- ifelse(is.na(data$Mean.Glucose.Basal),NA,
                                      ifelse(data$Mean.Glucose.Basal>70 & data$Mean.Glucose.Basal<90,"70 - <90 mg/dL",
                                             ifelse(data$Mean.Glucose.Basal>=90 & data$Mean.Glucose.Basal<110,"90 - <110 mg/dL",
                                                    ifelse(data$Mean.Glucose.Basal>=110 & data$Mean.Glucose.Basal<130,"110 - <130 mg/dL",
                                                           ifelse(data$Mean.Glucose.Basal>=130 & data$Mean.Glucose.Basal<150,"130 - <150 mg/dl",
                                                                  ">150 mg/dl")))))

# calculate means by BMI group
means <- data %>% group_by(bmi_twocat) %>% summarise_at(vars("Mean.Glucose.Basal","Basal.Insulin",
                                                             "Basal.glucose.Ra","Basal.FFA","Basal.glycerol",
                                                             "Basal.glycerol.RA"),mean,na.rm=T)

# need to make a long dataset

```

# Descriptive statistics, overall

```{r, include=F}
descdata <- data %>% select(-StudyID)
t1 <- CreateTableOne(data=descdata,vars=colnames(descdata))
t1 <- print(t1)
```

```{r, include=T}
kable(t1)
```

# Figure 1 - fasting data

## Glucose

```{r, include=T}
ggplot(data, aes(x=Basal.Insulin, y=Mean.Glucose.Basal, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

```{r, include=T}
ggplot(means, aes(x=Basal.Insulin, y=Mean.Glucose.Basal, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

## Glucose Ra

```{r, include=T}
ggplot(data, aes(x=Basal.Insulin, y=Basal.glucose.Ra, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

```{r, include=T}
ggplot(means, aes(x=Basal.Insulin, y=Basal.glucose.Ra, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

## Glycerol

```{r, include=T}
ggplot(data, aes(x=Basal.Insulin, y=Basal.glycerol, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

```{r, include=T}
ggplot(means, aes(x=Basal.Insulin, y=Basal.glycerol, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

## Glycerol Ra

```{r, include=T}
ggplot(data, aes(x=Basal.Insulin, y=Basal.glycerol.RA, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

```{r, include=T}
ggplot(means, aes(x=Basal.Insulin, y=Basal.glycerol.RA, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

## FFA

```{r, include=T}
ggplot(data, aes(x=Basal.FFA, y=Basal.glycerol.RA, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```

```{r, include=T}
ggplot(means, aes(x=Basal.FFA, y=Basal.glycerol.RA, color=bmi_twocat)) + 
      geom_point(size=6) +
      theme_ipsum()
```