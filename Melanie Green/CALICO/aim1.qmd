---
title: "CALICO Exploratory Data Analysis"
author: "Tim Vigers"
date: "today"
date-format: long
format:
  html:
    toc: true
    toc-depth: 5
    toc-float: true
    code-fold: true
    self-contained: true
    fig-cap-location: top
    fig-width: 12
    fig-height: 9
    page-layout: full
    theme:
      light: flatly
      dark: darkly
bibliography: C:/Users/timvigers/Dropbox/Miscellaneous/zotero.bib
csl: C:/Users/timvigers/Documents/GitHub/styles/american-medical-association.csl
editor: source
---

```{r setup}
#| include: false
library(tidyverse)
library(childsds)
library(arsenal)
home_dir <- switch(Sys.info()["sysname"],
  "Darwin" = "/Users/timvigers/Library/CloudStorage/OneDrive-TheUniversityofColoradoDenver/Vigers/BDC/Janet Snell-Bergeon/CALICO",
  "Windows" = "C:/Users/timvigers/OneDrive - The University of Colorado Denver/Vigers/BDC/Janet Snell-Bergeon/CALICO",
  "Linux" = "/home/timvigers/OneDrive/Vigers/BDC/Janet Snell-Bergeon/CALICO"
)
knitr::opts_knit$set(root.dir = home_dir)
```

```{r data import}
#| include: false
# Load data
load("./Data_Clean/analysis_data.RData")
# Set table options
mycontrols <-
  tableby.control(numeric.stats = c("Nmiss2", "meansd", "medianq1q3", "range"))
```

# Demographics

```{r results='asis'}
#| label: tbl-table-1
#| tbl-cap: Participant demographics
f <- as.formula(paste0("~", paste0(demo_vars, collapse = "+")))
t1 <- tableby(f,
  data = df[is.na(df$redcap_repeat_instrument), ], control = mycontrols
)
summary(t1, labelTranslations = labels(df), pfootnote = T)
```

# Aim 1 comparisons

## By age at diagnosis

```{r results='asis'}
#| label: tbl-table-1-age
#| tbl-cap: Stratified by age group at diagnosis
f <- as.formula(paste0("age_group ~ ", paste0(aim1_vars, collapse = "+")))
t1_age <- tableby(f,
  data = df[df$redcap_repeat_instance == 1, ], control = mycontrols
)
summary(t1_age, labelTranslations = labels(df), pfootnote = T)
```

## By BMI

```{r results='asis'}
#| label: tbl-table-1-age
#| tbl-cap: Stratified by age group at diagnosis
f <- as.formula(paste0("age_group ~ ", paste0(aim1_vars, collapse = "+")))
t1_age <- tableby(f,
  data = df[df$redcap_repeat_instance == 1, ], control = mycontrols
)
summary(t1_age, labelTranslations = labels(df), pfootnote = T)
```
