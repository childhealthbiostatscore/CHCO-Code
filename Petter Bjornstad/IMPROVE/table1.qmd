--- 
title: "RH and IMPROVE"
author: "Tim Vigers"
format:
  html:
    toc: true
    toc-depth: 5
    toc-float: true
    code-fold: true
    self-contained: true
    page-layout: full
editor: source
--- 

```{python}
#| include: false
import pandas as pd
from tableone import TableOne
# Import and filter
df = pd.read_csv("/Volumes/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/Peds Endo/Petter Bjornstad/Data Harmonization/Data Clean/harmonized_dataset.csv",low_memory=False,na_values="")
df = df[df["study"].isin(["IMPROVE","RENAL-HEIR"])  ]
df = df[['record_id', 'co_enroll_id', 'study','visit', 'age','sex','race','hba1c']]
df = df[df["visit"].isin(["baseline","pre_surgery"])]
# Aggregate
df = df.groupby(by=["record_id"]).agg("first").reset_index()
idx = [False if "IT" in str(r) else True for r in df["co_enroll_id"]]
df = df[idx]
```

```{python}
#| label: tbl-baseline
#| tbl-cap: Baseline Characteristics
cols = ['age', 'sex', 'race','hba1c']
cat = ['sex', 'race']
group = "study"
TableOne(data=df, columns=cols, categorical=cat, groupby=group)
```
