---
title: "ATTEMPT scRNA report"
author: "Ye Ji Choi"
format:
  revealjs:
    embed-resources: true
    scrollable: true
    transition: slide
    controls-layout: bottom-right
    menu: true
    toc: true
    toc-depth: 1
    fontsize: 15
---

```{r include = F}
library(jsonlite)
library(aws.s3)
library(knitr)
library(dplyr)
library(kableExtra)
library(tidyverse)
```

```{r include = F}
## Create an S3 client
keys <- fromJSON("/Users/choiyej/Library/CloudStorage/OneDrive-TheUniversityofColoradoDenver/Bjornstad Pyle Lab/keys.json")

Sys.setenv(
  "AWS_ACCESS_KEY_ID" = keys$MY_ACCESS_KEY,
  "AWS_SECRET_ACCESS_KEY" = keys$MY_SECRET_KEY,
  "AWS_DEFAULT_REGION" = "",
  "AWS_REGION" = "",
  "AWS_S3_ENDPOINT" = "s3.kopah.uw.edu"
)
```

# Introduction {data-name="Introduction"}

This is a report compiling results from the ATTEMPT scRNA analysis. 

Next steps:

- Complete the report

- Add MRI data

- Modify the volcano plots for clinical data (color by direction of dapa)

- Add table 1 of descriptions

- Stratify immune cells to lymphoid and myeloid

- Add "Up with Dapa, Down with Dapa" arrows to volcano plots

- Add model formula to volcano plots

- Add TIR

- Add scrolling menu?



# 1. Data Driven

- Used 2000 top HVG for each cell type

- NEBULA (~ treatment + visit + treatment * visit)

- Used pooled offset and REML in NEBULA

---

## 1a. DEGs (Dapagliflozin vs. Placebo) - DiD using NEBULA across all celltypes  {data-name="Introduction2"}

![PT](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/pt_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![TAL](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/tal_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![PC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/pc_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![Immune](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/immune_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![EC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/ec_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![IC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/ic_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}
![FIB/VSMC/P](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/fibvsmc_placebo_pvalue_nebula_reml_pooled.jpeg){width=70%}


---

## 1b. GSEA


### Positive PT KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative PT KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive PT Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative PT Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive PT GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative PT GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PT GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pt_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))}
```

---

### Positive TAL KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative TAL KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive TAL Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative TAL Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive TAL GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative TAL GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### TAL GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/tal_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive PC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative PC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive PC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative PC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive PC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative PC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### PC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/pc_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive Immune KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative Immune KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive Immune Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative Immune Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive Immune GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative Immune GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### Immune GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/immune_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))
}
```

---


### Positive IC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative IC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive IC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative IC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive IC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative IC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### IC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ic_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))}
```

---


### Positive EC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative EC KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive EC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative EC Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive EC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))

}
```

---

### Negative EC GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### EC GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/ec_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))
}
```

---


### Positive FIB/VSMC/P KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("FIB/VSMC/P KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative FIB/VSMC/P KEGG
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### FIB/VSMC/P KEGG Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_kegg_legacy.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_kegg_legacy_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive FIB/VSMC/P Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### FIB/VSMC/P Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_reactome.jpeg){width=70%}\n\n"))

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative FIB/VSMC/P Reactome
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### FIB/VSMC/P Reactome Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_reactome.jpeg){width=70%}\n\n"))
  
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_reactome_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Positive FIB/VSMC/P GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### FIB/VSMC/P GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_go.jpeg){width=70%}\n\n"))
    cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_pos", i, "_go_heatmap.jpeg){width=70%}\n\n"))
}
```

---

### Negative FIB/VSMC/P GO
```{r echo=FALSE, results='asis'}
for (i in 1:10) {
  cat("#### FIB/VSMC/P GO Pathway Top ", i, "\n\n")  # Adds a section header

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_go.jpeg){width=70%}\n\n"))
  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/fibvsmc_nebula_neg", i, "_go_heatmap.jpeg){width=70%}\n\n"))
  }
```

---


## 1c. IPA

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmcp")

for (cells in celltype_list) {
  cat("### Activated IPA Pathway for", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Z score bar plots/nebula/", cells, "_top10_activated_pathway_zscores.jpeg)\n\n"))
}
```

---

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmcp")

for (cells in celltype_list) {
  cat("### Inhibited IPA Pathway for", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Z score bar plots/nebula/", cells, "_top10_inhibited_pathway_zscores.jpeg){width=80%}\n\n"))
}
```


# 2. T1D vs. HC - informed

---


## 2a. T1D (CRC T1D vs. HC, same approach as #1)

![PT](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/pt_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![TAL](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/tal_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![PC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/pc_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![Immune](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/immune_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![EC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/ec_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![IC](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/ic_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}
![FIB/VSMC/P](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/CROCODILE comparison analysis/fibvsmc_croc_pvalue_nebula_reml_offset_croc.jpeg){width=70%}

---

## 2b. T1D (CRC T1D + BL ATTEMPT vs. HC, same approach as #1)

- Work in progress...

---

## 2c. Evaluate the effect of Dapagliflozin vs. Placebo on these DEGs characteristic of T1D

- Work in progress...

---

# 3. Change in cell type proportions

Stats in progress using scDC: https://sydneybiox.github.io/scDC/articles/vignette.html

![PT](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Proportions/attempt_pt_scdc_barplot.png){width=70%}

![PT](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Proportions/attempt_pt_scdc_densityplot.png){width=70%}

---


## 3a. T1D vs. HC

---

## 3b. T1D PRE vs. POST in Placebo

```{r echo = F, results='asis'}
propeller_res <- s3readRDS("PT/pt_propeller_combined.rds", "attempt", region ="")
propeller_res_placebo <- propeller_res %>% 
  filter(treatment == "Placebo") %>%
  arrange(celltype) %>%
  dplyr::select(PropMean.PRE, PropMean.POST, PropRatio, P.Value, FDR)

kable(propeller_res_placebo,format = "html", 
      digits = 3)  %>%
  kable_styling(font_size = 20,
                bootstrap_options = c("striped", "hover", "condensed"),
                full_width = FALSE)
```

**No significant change** in PT cell type proportion was observed in the placebo group post treatment. Numeric increase in PT-1, PT-2, and PT-3 cells were observed, and numeric decrease in PT-4 and PT-5 cells were observed.

---

## 3c. T1D PRE vs. POST in Dapagliflozin


```{r echo = F, results='asis'}
propeller_res_dapa <- propeller_res %>% 
  filter(treatment == "Dapagliflozin") %>%
  arrange(celltype) %>%
  remove_rownames() %>%
  column_to_rownames("celltype") %>%
  dplyr::select(PropMean.PRE, PropMean.POST, PropRatio, P.Value, FDR)

kable(propeller_res_dapa,format = "html", 
      digits = 3)  %>%
  kable_styling(font_size = 20,
                bootstrap_options = c("striped", "hover", "condensed"),
                full_width = FALSE)
```

**No significant change** in PT cell type proportion was observed in the dapagliflozin group post treatment. Numeric increase in PT-1, and PT-2 cells were observed, and numeric decrease in PT-3, PT-4, and PT-5 cells were observed.


---

# 4. Pseudotime trajectories

---

## 4a. T1D vs. HC (Cross sectional)

---

## 4b. Dapagliflozin vs. Placebo in T1D (serial data)

---

# 5. Associate DEGs with clinical markers adjusting for treatment group

---

## 5a. Change in mGFR (raw)

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_mgfr_raw.jpeg){width=70%}\n\n"))
}
```

---

### IPA


---


### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_raw_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_raw_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_raw_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

## 5b. Change in mGFR (BSA)

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_mgfr_bsa.jpeg){width=70%}\n\n"))
}
```

---

### IPA


---


### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_bsa_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_bsa_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_mgfr_bsa_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

## 5c. Change in TIR

Waiting for TIR data from Antoine

---

## 5d. Change in HbA1c

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_hba1c.jpeg){width=70%}\n\n"))
}
```

---


### IPA


---


### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_hba1c_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_hba1c_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_hba1c_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

## 5e. Change in weight

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_weight.jpeg){width=70%}\n\n"))
}
```

---



### IPA


---


### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_weight_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_weight_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_weight_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

## 5f. Change in avg cortical R2*
```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_avg_c_r2.jpeg){width=70%}\n\n"))
}
```

---


### IPA


---


### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_c_r2_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_c_r2_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_c_r2_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

## 5g. Change in avg kidney R2*

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Volcano Plots/nebula/", cells, "_avg_k_r2.jpeg){width=70%}\n\n"))
}
```

---

### IPA

---

### GSEA

#### KEGG

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_k_r2_top30_kegg_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### REACTOME

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_k_r2_top30_reactome_pathways.jpeg){width=70%}\n\n"))
}
```

---

#### GO

```{r echo = F, results = 'asis', eval = T}
celltype_list <- c("pt", "tal", "pc", "immune", "ic", "ec", "fibvsmc")

for (cells in celltype_list) {
  cat("#### ", toupper(cells), "\n\n") 

  cat(paste0("![](/Users/choiyej/Library/CloudStorage/OneDrive-SharedLibraries-UW/Laura Pyle - Bjornstad/Biostatistics Core Shared Drive/ATTEMPT/Results/Figures/Pathways/nebula/", cells, "_avg_k_r2_top30_go_pathways.jpeg){width=70%}\n\n"))
}
```

---

# 6. Cell-to-cell interaction

---

## 6a. T1D vs. HC

---

## 6b. Dapagliflozin vs. Placebo

---

# 7. Associate DEGs w/ proteomics

---

## 7a. EC DEGs with change in plasma proteomics

---

## 7b. PT DEGs with change in urine proteomics

---

## 7c. TAL DEGs with change in urine proteomics
