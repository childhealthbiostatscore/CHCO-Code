---
title: "PANTHER Analysis (w/ RH, RH2, IMPROVE subset)"
author: "Ye Ji Choi"
date: "`r lubridate::today()`"
format: 
  html:
    toc: true
    toc-depth: 5
    toc-location: left
    code-fold: true
    embed-resources: true
---

Save related files for further analysis and descriptive table of PANTHER

```{r libraries, echo=F, include = F}
library(SomaDataIO)
library(tidyverse)
library(growthcleanr)
library(arsenal)
library(dplyr)
library(naniar)
library(ggplot2)
library(ggrepel)
library(ggpubr)
library(pedbp)
```

```{r load-data, echo = F, include = F}
# Load SOMAScan analytes data
load("/Volumes/Peds Endo/Petter Bjornstad/Data Harmonization/Combined SomaScan/analytes.Rdata")

# Load dictionary function and file
source("/Users/choiyej/GitHub/YC_CHCO/R Functions/label_harmonized_function.R")
```

```{r prep-data, echo = F, include = F}
# Load clinical data
harm_dat <- read.csv("/Volumes/Peds Endo/Petter Bjornstad/Data Harmonization/Data Clean/soma_harmonized_dataset.csv", na.strings = "")
exclude <- read.csv("/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_withdrew_ltfu_list.csv")$record_id

dat <- harm_dat %>% filter((study == "PANTHER" & visit == "baseline")|study == "RENAL-HEIR"|
                             study == "RENAL-HEIRitage" | (study == "IMPROVE" & visit == "baseline")) %>%
  # filter(record_id %nin% exclude) %>% # Not removing anyone with proteomics data
  dplyr::summarise(across(where(negate(is.numeric)), ~ ifelse(all(is.na(.x)), NA_character_, last(na.omit(.x)))),
                   across(where(is.numeric), ~ ifelse(all(is.na(.x)), NA_real_, mean(.x, na.rm = TRUE))),
                   .by = c(mrn, screen_date)) %>%
  # filter(participation_status!="Removed"|is.na(participation_status)) %>%
  dplyr::mutate(race_ethnicity_condensed = case_when(race == "White" & 
                                                ethnicity == "Not Hispanic or Latino" ~ "Not Hispanic or Latino White",
                                              race == "Black or African American" & 
                                                ethnicity == "Not Hispanic or Latino" ~ "Not Hispanic or Latino Black",
                                              ethnicity == "Hispanic or Latino" ~ "Hispanic or Latino",
                                              T ~ "Not Hispanic or Latino Other"),
         tanner_stage_comp = coalesce(tan_fgd, tan_fph, tan_tveq, tan_mgd, tan_mph, breast_tanner),
         tanner_stage_comp_panther = case_when(tanner_stage_comp > 3 ~ 4, T~ tanner_stage_comp),
         tanner_stage_cat = case_when(tanner_stage_comp <3 ~ "I_II",
                                      tanner_stage_comp >=3 ~ "III_V"),
         tanner_stage_cat_2 = case_when(tanner_stage_comp == 1 ~ "I",
                                        tanner_stage_comp <4 ~ "II_III",
                                        tanner_stage_comp >=4 ~ "IV_V"),
         tanner_stage_cat_3 = case_when(tanner_stage_comp < 2 ~ "I_II",
                                        tanner_stage_comp == 3 ~ "III",
                                        tanner_stage_comp >= 4 ~ "IV_V"),
         tanner_stage_comp_panther_cat = 
                  case_when(tanner_stage_comp_panther == 4 ~ "4 & 5",
                            T ~ as.character(tanner_stage_comp_panther)),
         age_mo = (age * 12),
         sex = case_when(sex == "Male" ~ "male",
                         sex == "Female" ~ "female"),
         male_ind = case_when(sex == "male" ~ 1, sex == "female" ~ 0),
         combined_tkv = coalesce(total_kidney_volume_ml, total_kidney_volume_ml_manual),
         combined_ht_tkv = coalesce(ht_adj_tkv, ht_adj_tkv_manual),
         log_tot_test = log(tot_test),
         log_free_test = log(free_test),
         log_lh = log(lh),
         log_estrad = log(estrad),
         avg_c_adc_tkv = avg_c_adc/combined_tkv,
         avg_c_r2_tkv = avg_c_r2/combined_tkv,
         avg_pcascl_tkv = avg_pcascl/combined_tkv,
         avg_c_t1_tkv = avg_c_t1/combined_tkv,
         mm_airg = case_when(mm_airg > 0 ~ mm_airg),
         mm_bcell = case_when(mm_bcell > 0 ~ mm_bcell),
         mm_di = case_when(mm_di > 0 & mm_di < 10000 ~ mm_di),
         mm_ir = case_when(mm_ir > 0 ~ mm_ir),
         mm_si = case_when(mm_si > 0 & mm_si < 500 ~ mm_si)) %>%
  arrange(record_id) %>%
  filter(!is.na(male_ind)) # RH2-54-T is currently missing all data excpet MRI
  #filter(!is.na(seq.10000.28)) # no need to subset to proteomics yet...

dat$tanner_stage_comp <- as.factor(dat$tanner_stage_comp)

bp_percentile = p_bp(q_sbp = dat$sbp, q_dbp = dat$dbp, age = dat$age_mo, male = dat$male_ind)
dat$sbp_p <- bp_percentile$sbp_p
dat$dbp_p <- bp_percentile$dbp_p

bmi_percentile = ext_bmiz(data = subset(dat, 
                                        select = c("record_id", "sex", "age_mo", "weight", "height", "bmi")), 
                          age = "age_mo", 
                          wt = "weight", 
                          ht = "height", 
                          bmi = "bmi", 
                          adjust.integer.age = F) %>% 
  dplyr:: select(record_id, bmip)
dat <- left_join(dat, bmi_percentile, by = "record_id") %>%
  dplyr::mutate(group_risk = case_when(bmip >= 85 | hba1c >=6 | group == "Type 2 Diabetes" ~ "High",
                                       T ~ "Low"),
                sex_group_risk = case_when(sex == "male" & group_risk == "High" ~ "M, High",
                                           sex == "male" & group_risk == "Low" ~ "M, Low",
                                           sex == "female" & group_risk == "High" ~ "F, High",
                                           sex == "female" & group_risk == "Low" ~ "F, Low"))

panther <- dat %>% filter(study == "PANTHER") %>%
  filter(!is.na(tanner_stage_comp))
sens_dat <- dat %>% filter(study == "PANTHER" | study == "RENAL-HEIR") %>%
  filter(!is.na(tanner_stage_comp))

# Prepare SOMA data
# prepare data set for analysis
cleanData_comb <- dat |>
  mutate_at(getAnalytes(dat), ~ as.numeric(scale(log(.))))

cleanData_panther <- cleanData_comb %>%
  filter(study == "PANTHER") %>%
  filter(!is.na(tanner_stage_comp))
cleanData_sens <- cleanData_comb %>%
  filter(study == "PANTHER" | study == "RENAL-HEIR") %>%
  filter(!is.na(tanner_stage_comp))

analytes <- analytes %>% dplyr::mutate(Target_nodup = paste0(Target, " (", AptName, ")"))

# Load and modify dictionary file
dict <- read.csv("/Volumes/Peds Endo/Petter Bjornstad/Data Harmonization/data_dictionary_master.csv")

dict <- label_harmonized_dict(dat, dict) %>%
  dplyr::mutate(tanner_stage_comp = "Tanner stage",
         tanner_stage_comp_ord = "Tanner stage",
         tanner_stage_cat = "Tanner stage categorized (1/2, 3/4/5)",
         tanner_stage_cat2 = "Tanner stage categorized (1, 2/3, 4/5)",
         mm_airg = "AIRg",
         mm_bcell = "Beta cell function",
         mm_di = "DI",
         mm_ir = "Insulin resistance",
         mm_si = "Insulin sensitivity",
         bmip = "BMI percentile",
         total_kidney_volume_ml_manual = "Total Kidney Volume (mL; manual)",
         ht_adj_tkv_manual = "Height Adjusted Total Kidney Volume (mL/m; manual)",
         combined_tkv = "Collapsed Total Kidney Volume (mL)", 
         combined_ht_tkv = "Collapsed Height Adjusted Total Kidney Volume (mL/m)",
         fsh = "FSH (mIU/mL)", 
         lh = "LH (mIU/mL)", 
         estrad = "Estradiol (pg/mL)",
         tot_test = "Total testosterone (ng/dL)",
         free_test = "Free testosterone (pg/mL)",
         igf_1 = "IGF-1",
         igf1_z_score = "IGF-1 Z-score",
         avg_c_t1 = "Avg cortical T1",
         avg_pcascl = "Avg pCASCL",
         avg_c_adc_tkv = "Avg cortical ADC/TKV",
         avg_c_r2_tkv = "Avg cortical R2*/TKV",
         avg_pcascl_tkv = "Avg cortical ASL/TKV",
         avg_c_t1_tkv = "Avg cortical T1/TKV", 
         sbp_p = "SBP percentile",
         dbp_p = "DBP percentile")%>%
  dplyr::select(-starts_with("seq."))

analytes_dict <- analytes %>%
  dplyr::mutate(target_mod = Target_nodup) %>%
  column_to_rownames("AptName") %>%
  dplyr::select(target_mod) %>%
  t()

dict <- cbind(dict[1,], analytes_dict)

# Label data
dat <- label_harmonized(dat, dict)
panther <- label_harmonized(panther, dict)
sens_dat <- label_harmonized(sens_dat, dict)

# panther_id <- as.character(panther$record_id)
# panther2_id <- as.character(panther_2$record_id)
# setdiff(panther_id, panther2_id)
```

```{r save-data, include = F}
# save(analytes,
#      file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_analytes.RData")
# save(dict,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_dict.RData")
# save(dat,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther+rh+rh2+imp_data.RData")
# save(panther,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_data.RData")
# save(sens_dat,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_rh_rh2_imp_data.RData")
# save(cleanData_comb,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther+rh+rh2+imp_data_soma_std.RData")
# save(cleanData_panther,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_data_soma_std.RData")
# save(cleanData_sens,
#         file = "/Volumes/Peds Endo/Petter Bjornstad/PANTHER/Data_Cleaned/panther_data_rh_rh2_imp_std.RData")
```

# Descriptive table

## PANTHER only

### By risk

```{r desc-risk, results = 'asis', echo = F}
# Descriptive tables
## By risk
summary(tableby(group_risk ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = panther, total = T, test = F))
```

#### Low risk
```{r, results = 'asis', echo = F}
# Descriptive tables
## By risk
summary(tableby(sex ~ age + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = subset(panther, group_risk == "Low"), total = T, test = F))
```
#### High risk
```{r, results = 'asis', echo = F}
# Descriptive tables
## By risk
summary(tableby(sex ~ age + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = subset(panther, group_risk == "High"), total = T, test = F))
```

### By tanner stage

```{r desc-tanner-stage, results = 'asis', echo = F}
# By tanner stage
summary(tableby(tanner_stage_comp ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = panther, total = T, test = F))

vars <- c("age", "height", "weight", "bmi", "birthweight", "group", "eGFR_CKD_epi", "sbp", "dbp", "hba1c", "ast", "alt", "acr_u", "tot_test", "free_test", "estrad", "lh", "fsh", "dhea", "igf_1", "igf_bp3", "race_ethnicity", "meds_metformin", "meds_insulin", "meds_glp1ra", "meds_sglt2i", "dexa_lean_mass", "dexa_body_fat", "dexa_fat_kg", "dexa_trunk_mass", "avg_c_r2", "avg_m_r2", "avg_c_t1", "avg_pcascl", "avg_c_adc", "total_kidney_volume_ml", "ht_adj_tkv", "mm_si", "mm_ir", "mm_di", "gfr_raw_plasma", "gfr_raw_plasma", "erpf_raw_plasma", "erpf_bsa_plasma", "ra", "re", "rvr", "glomerular_pressure")

vars[vars %nin% colnames(panther)]


```

### By tanner stage (4 & 5 combined)

```{r desc-tanner-stage-45, results = 'asis', echo = F}
# By tanner stage
summary(tableby(tanner_stage_comp_panther_cat ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = panther, total = T, test = F))
```

### IQR plots
```{r echo = F, warning = F}
iqr_plot <- function(data, x_var, y_var,
                     x_var_lab, y_var_lab) {
  ggplot(data = data, aes_string(x = x_var, y = y_var)) +
    geom_jitter(width = 0.2, alpha = 0.5) +
    stat_summary(
      fun = median, 
      geom = "crossbar", 
      width = 0.1) + 
    stat_summary(
      fun = median, 
      geom = "line",
      group = 1) + 
    stat_summary(
      fun.data = function(x) {
        data.frame(
          y = median(x),
          ymin = quantile(x, 0.25),
          ymax = quantile(x, 0.75))
      },
      geom = "errorbar", 
      width = 0.2) + 
    labs(x = x_var_lab,
         y = y_var_lab) +
    theme(panel.background = element_blank(),
          text = element_text(size = 20))
}
```

#### Pooled
```{r echo = F, warning = F}
iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "total_kidney_volume_ml", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "ht_adj_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "glomerular_pressure",
         x_var_lab = "Tanner stage", y_var_lab = "PGLO")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_si",
         x_var_lab = "Tanner stage", y_var_lab = "SI")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_di",
         x_var_lab = "Tanner stage", y_var_lab = "DI")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_airg",
         x_var_lab = "Tanner stage", y_var_lab = "AIRg")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_bcell",
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_adc_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_r2_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV")

iqr_plot(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_pcascl_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV")

iqr_plot(data = panther,
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_t1_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV")

```


```{r echo = F, warning = F}
iqr_plot_grp <- function(data, x_var, y_var, group_var = NULL,
                     x_var_lab, y_var_lab, group_lab = NULL,
                     colors = NULL) {
  p <- ggplot(data = data, aes_string(x = x_var, y = y_var, 
                                 color = group_var)) +
    geom_jitter(width = 0.2, alpha = 0.5) +
    stat_summary(
      fun = median, 
      geom = "crossbar", 
      width = 0.2) + 
    stat_summary(
      fun.data = function(x) {
        data.frame(
          y = median(x),
          ymin = quantile(x, 0.25),
          ymax = quantile(x, 0.75))
      },
      geom = "errorbar", 
      width = 0.2,
      size = 2,
      aes_string(linetype = group_var)) + 
    stat_summary(
      fun = median, 
      geom = "line",
      aes_string(group = group_var,
                 linetype = group_var),
      size = 2) + 
    stat_compare_means(
      method = "anova",
      aes(label = ..p.signif..),
      label.x.npc = "center", 
      label.y.npc = "top",
      size = 6) +
    labs(x = x_var_lab,
         y = y_var_lab,
         color = group_lab,
         linetype = group_lab) +
    theme(panel.background = element_blank(),
          text = element_text(size = 23))
  if(!is.null(colors)){
    p <- p + scale_color_manual(values = colors)
  }
  return(p)
}

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_si",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Risk group")
```

#### Risk
```{r echo = F, warning = F}
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "total_kidney_volume_ml",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "ht_adj_tkv",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "glomerular_pressure",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_si",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_di",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Risk group") 

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_airg",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_bcell",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Risk group")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_adc_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_r2_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Risk group")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_pcascl_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Risk group")

iqr_plot_grp(data = panther,
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_t1_tkv", group_var = "group_risk",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Risk group")

```
#### Sex
```{r echo = F, warning = F}
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "total_kidney_volume_ml",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "ht_adj_tkv",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "gfr_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "erpf_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "glomerular_pressure",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_si",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_di",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Sex")


iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_airg",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "mm_bcell",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Sex")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_adc_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_r2_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Sex")

iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_pcascl_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Sex")

iqr_plot_grp(data = panther,
         x_var = "tanner_stage_comp_panther_cat", y_var = "avg_c_t1_tkv", group_var = "sex",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Sex")
```
#### Risk + sex

```{r, results = 'asis', echo = F}
# Descriptive tables
## By risk & sex
summary(tableby(sex_group_risk ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = panther, total = T, test = F))
```

```{r echo = F, warning = F}
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "fsh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "FSH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "log_lh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log LH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "log_estrad",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log estradiol (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "log_tot_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log total testosterone (ng/dL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "log_free_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log free testosterone (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "igf_1",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = panther, 
         x_var = "tanner_stage_comp_panther_cat", y_var = "igf1_z_score",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1 Z-score", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
```

### Outliers and missingness
```{r echo = F, warning = F, include = F}
vis_miss(subset(panther, select=c(gfr_raw_plasma, gfr_bsa_plasma, erpf_raw_plasma, erpf_bsa_plasma, record_id)), facet = record_id)

vis_miss(subset(panther, select=c(total_kidney_volume_ml, ht_adj_tkv, record_id)), facet = record_id)

vis_miss(subset(panther, select=c(mm_airg, mm_bcell, mm_di, mm_ir, mm_si, record_id)), facet = record_id)

vis_miss(subset(panther, select=c(dexa_body_fat, dexa_fat_kg, dexa_lean_mass, dexa_lean_kg, dexa_trunk_mass, dexa_trunk_kg, dexa_bone_mineral_density, record_id)), facet = record_id)

vis_miss(subset(panther, select=c(fsh, lh, estrad, tot_test, free_test, record_id)), facet = record_id)

# Function to generate boxplot
create_boxplot <- function(data, variable) {
  # Calculate IQR and quantiles while removing NA values
  Q1 <- quantile(data[[variable]], 0.25, na.rm = TRUE)
  Q3 <- quantile(data[[variable]], 0.75, na.rm = TRUE)
  IQR_value <- IQR(data[[variable]], na.rm = TRUE)
  
  # Define outlier condition
  outlier_condition <- data[[variable]] < (Q1 - 1.5 * IQR_value) | data[[variable]] > (Q3 + 1.5 * IQR_value)
  
  p <- ggplot(data = data, aes(x = "", y = !!sym(variable))) +
    geom_boxplot(outlier.colour = "red", outlier.shape = 16) +
    geom_text_repel(
      data = data %>% filter(outlier_condition),
      aes(label = paste0(record_id, ", ", !!sym(variable))),
      nudge_x = 0.3, 
      size = 3
    ) +
    labs(y = variable) +
    theme_bw()
}

# List of variables to plot
variables <- c("age", "weight", "height", "bmi", "bmip", "hba1c", "gfr_raw_plasma", "gfr_bsa_plasma", "erpf_raw_plasma", "erpf_bsa_plasma", "total_kidney_volume_ml", "ht_adj_tkv", "mm_airg", "mm_bcell", "mm_di", "mm_ir", "mm_si", "dexa_body_fat", "dexa_fat_kg", "dexa_lean_mass", "dexa_lean_kg", "dexa_trunk_mass", "dexa_trunk_kg", "dexa_bone_mineral_density", "fsh", "lh", "estrad", "tot_test", "free_test")

# Create list of plots
plots <- lapply(variables, create_boxplot, data = panther)

# If you want to display the plots
for (plot in plots) {
  print(plot)
}
```

## PANTHER + RH

### By risk

```{r desc-risk-sens, results = 'asis', echo = F}
# Descriptive tables
## By risk
summary(tableby(group_risk ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = sens_dat, total = T, test = F))
```

### By tanner stage

```{r desc-tanner-stage-sens, results = 'asis', echo = F}
## By tanner stage
summary(tableby(tanner_stage_comp ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = sens_dat, total = T, test = F))
```
### IQR plots

#### Pooled
```{r echo = F, warning = F}
iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",
         x_var_lab = "Tanner stage", y_var_lab = "PGLO")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",
         x_var_lab = "Tanner stage", y_var_lab = "SI")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",
         x_var_lab = "Tanner stage", y_var_lab = "DI")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",
         x_var_lab = "Tanner stage", y_var_lab = "AIRg")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL")

iqr_plot(data = sens_dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV")

iqr_plot(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV")

iqr_plot(data = sens_dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV")

```

#### Risk
```{r echo = F, warning = F}
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Risk group") 

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Risk group")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Risk group")

iqr_plot_grp(data = sens_dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv", group_var = "group_risk",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Risk group")

```
#### Sex
```{r echo = F, warning = F}
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Sex")


iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Sex")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL", group_lab = "Sex")

iqr_plot_grp(data = sens_dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1", group_var = "sex",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Sex")

iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Sex")

iqr_plot_grp(data = sens_dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv", group_var = "sex",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Sex")

```
#### Risk + sex

```{r desc-risk-sex, results = 'asis', echo = F}
# Descriptive tables
## By risk & sex
summary(tableby(sex_group_risk ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = sens_dat, total = T, test = F))
```

```{r echo = F, warning = F}
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "fsh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "FSH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "log_lh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log LH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "log_estrad",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log estradiol (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "log_tot_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log total testosterone (ng/dL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "log_free_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log free testosterone (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "igf_1",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = sens_dat, 
         x_var = "tanner_stage_comp", y_var = "igf1_z_score",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1 Z-score", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
```

## PANTHER + RH + RH2 + IMPROVE

### By risk

```{r desc-risk-comb, results = 'asis', echo = F}
# Descriptive tables
## By risk
summary(tableby(group ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = dat, total = T, test = F))
```
### IQR plots

#### Pooled
```{r echo = F, warning = F}
iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",
         x_var_lab = "Tanner stage", y_var_lab = "PGLO")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",
         x_var_lab = "Tanner stage", y_var_lab = "SI")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",
         x_var_lab = "Tanner stage", y_var_lab = "DI")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",
         x_var_lab = "Tanner stage", y_var_lab = "AIRg")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL")

iqr_plot(data = dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV")

iqr_plot(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV")

iqr_plot(data = dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV")

```

#### Risk
```{r echo = F, warning = F}
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Risk group") 

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Risk group")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Risk group")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv", group_var = "group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Risk group")

iqr_plot_grp(data = dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv", group_var = "group_risk",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Risk group")

```
#### Sex
```{r echo = F, warning = F}
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "total_kidney_volume_ml",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "ht_adj_tkv",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Total kidney volume (Height adjusted)", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (Raw)", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "gfr_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "GFR (BSA)", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_raw_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (Raw)", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "erpf_bsa_plasma",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "RPF (BSA)", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "glomerular_pressure",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "PGLO", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_si",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "SI", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_di",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "DI", group_lab = "Sex")


iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_airg",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "AIRg", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "mm_bcell",group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Beta cell function", group_lab = "Sex")

# Add other MRI parameters
# (ADC, R2*, ASL, T1 mapping)
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL", group_lab = "Sex")

iqr_plot_grp(data = dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1", group_var = "sex",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_adc_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical ADC/TKV", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_c_r2_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical R2*/TKV", group_lab = "Sex")

iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "avg_pcascl_tkv", group_var = "sex", 
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical pCASCL/TKV", group_lab = "Sex")

iqr_plot_grp(data = dat,
         x_var = "tanner_stage_comp", y_var = "avg_c_t1_tkv", group_var = "sex",
         x_var_lab = "Tanner stage", y_var_lab = "Avg cortical T1/TKV", group_lab = "Sex")

```
#### Risk + sex

```{r, results = 'asis', echo = F}
# Descriptive tables
## By risk & sex
summary(tableby(sex_group_risk ~ age + sex + tanner_stage_comp + group + weight + height + bmi + bmip + hba1c + gfr_raw_plasma + gfr_bsa_plasma + erpf_raw_plasma + erpf_bsa_plasma + total_kidney_volume_ml + ht_adj_tkv + avg_c_adc + avg_c_r2 + avg_pcascl + avg_c_t1 + avg_c_adc_tkv + avg_c_r2_tkv + avg_pcascl_tkv + avg_c_t1_tkv + mm_airg + mm_bcell + mm_di + mm_ir + mm_si + dexa_body_fat + dexa_fat_kg + dexa_lean_mass + dexa_lean_kg + dexa_trunk_mass + dexa_trunk_kg + dexa_bone_mineral_density + fsh + kwt(lh, "Nmiss", "medianq1q3", "range") + kwt(estrad, "Nmiss", "medianq1q3", "range") + kwt(tot_test, "Nmiss", "medianq1q3", "range") + kwt(free_test, "Nmiss", "medianq1q3", "range") + igf_1 + igf1_z_score  + sbp + dbp + sbp_p + dbp_p, data = dat, total = T, test = F))
```

```{r echo = F, warning = F}
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "fsh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "FSH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "log_lh",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log LH (mIU/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "log_estrad",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log estradiol (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "log_tot_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log total testosterone (ng/dL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "log_free_test",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "Log free testosterone (pg/mL)", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "igf_1",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
iqr_plot_grp(data = dat, 
         x_var = "tanner_stage_comp", y_var = "igf1_z_score",group_var = "sex_group_risk", 
         x_var_lab = "Tanner stage", y_var_lab = "IGF-1 Z-score", group_lab = "Risk group",
         colors = c("#b23a48", "#fcb9b2", "#003049","#669bbc"))
```
