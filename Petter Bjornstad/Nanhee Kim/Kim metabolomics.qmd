---
title: "Nanhee Kim metabolomics data"
author: "Laura Pyle"
date: "`r lubridate::today()`"
format:
  revealjs:
    embed-resources: true
    scrollable: true
    transition: slide
    controls-layout: bottom-right
    menu: true
    toc: true
    toc-depth: 1
    fontsize: 20
---

```{r include = F}
library(jsonlite)
library(aws.s3)
library(dplyr)
library(knitr)
library(readxl)
library(corrplot)
library(gtools)
library(here)
```

```{r include = F}

```

# Association of top 20 HTN proteins with adiposity in TODAY (unadjusted models)

* Select top 20 proteins associated with time to hypertension in unadjusted Cox models in the TODAY data
* Correlate the top 20 proteins with adiposity in TODAY

```{r results='asis', dpi=1200, include=FALSE}
# correlate proteins with change in BMI, DXA
prot_heatmap <- seq_keep
colnames_M <- analytes %>%
  filter(AptName %in% seq_keep) %>%
  pull(Target)
colnames_M <- paste0(colnames_M,"_",prot_heatmap)
png(file = "heatmap_TODAY_htn_adiposity.png", res = 170, width = 3000, height = 2500)
corr_plot_modified_nodict(data=soma_keep, 
                   Y=soma_keep[,seq_keep],   
                 X=soma_keep[,c("Baseline BMI", "Baseline DXA % fat", "Baseline DXA corrected % fat", "Slope - BMI","Slope - DXA % body fat","Slope - DXA corrected % body fat")],
                 cor_method="spearman", adj_var = NA,
                 colnames_M=colnames_M)
dev.off()
```

![](heatmap_TODAY_htn_adiposity.png){.r-fit-text}


