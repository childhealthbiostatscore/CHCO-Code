---
title: "Liver scRNA analysis"
author: "Ye Ji Choi"
date: "`r lubridate::today()`"
format: 
  html:
    toc: true
    toc-depth: 5
    toc-location: left
    code-fold: true
    embed-resources: true
---

```{r libraries, echo=F, include = F}
library(tidyverse)
library(arsenal)
library(dplyr)
library(ggplot2)
library(ggrepel)
```

```{r}
so_liver_sc <- readRDS("/Volumes/Peds Endo/Petter Bjornstad/scRNA/data_raw/PB_Liver_7SingleCellDatasets.RDS")
# so_liver <- readRDS("/Volumes/Peds Endo/Petter Bjornstad/scRNA/data_raw/PB_liver_6datasets_HarmontIntegration_200mingenes_labelled_010924.RDS")
so_liver_sn <- readRDS("/Volumes/Peds Endo/Petter Bjornstad/scRNA/data_raw/NoRef_PetterLiver_ClinData_Labels_Char_041924.RDS")

View(so_liver_sn@meta.data)

unique(so_liver_sn@meta.data$pid) 

# identify missing StudyID using orig.ident and merge
liver_ids <- read.csv("/Volumes/Peds Endo/Petter Bjornstad/scRNA/data_clean/liver_biopsy_ids.csv") %>%
  dplyr::select(record_id, cryostor_id)

so_liver_sc_meta <- so_liver_sc@meta.data %>%
  dplyr::mutate(cryostor_id = gsub("-Liv", "", orig.ident)) %>%
  left_join(liver_ids)


```
