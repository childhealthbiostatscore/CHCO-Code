---
title: "eGFR vs. mGFR"
author: "Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    theme: readable
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
library(dplyr)

knitr::opts_chunk$set(echo = FALSE,warning = FALSE)

home_dir = ifelse(.Platform$OS.type != "unix","E:/Petter Bjornstad/eGFR vs mGFR/Data raw",
                  "/Volumes/som/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects")
knitr::opts_knit$set(root.dir = home_dir)

```

```{r, include=FALSE}
# read in data

# CROCODILE
crocodile <- read.csv("./CROCODILE-EGFRVsMGFR_DATA_2022-02-25_1840.csv")
crocodile$gfr <- crocodile$gfr_raw
crocodile$gfr_raw <- NULL
crocodile$age <- crocodile$age_consent
crocodile$age_consent <- NULL
crocodile$sex_MF <- ifelse(crocodile$sex==1,"M",
                           ifelse(!is.na(crocodile$sex),"F",NA))
crocodile$sex <- NULL
# did anyone check more than one race/ethnicity category
crocodile$race_sum <- rowSums(crocodile[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)
crocodile$clamp_weight <- crocodile$clamp_wt
crocodile$clamp_wt <- NULL
crocodile$clamp_height <- crocodile$clamp_ht
crocodile$clamp_ht <- NULL

# CASPER
casper <-  read.csv("./CASPER-EGFRVsMGFR_DATA_2022-02-25_1839.csv")
casper$age <- casper$age_current
casper$age_current <- NULL
casper$sex_MF <- ifelse(casper$gender==1,"M",
                           ifelse(!is.na(casper$gender),"F",NA))
casper$gender <- NULL
# did anyone check more than one race/ethnicity category - yes, 2 people
casper$race_sum <- rowSums(casper[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)

# COFFEE - get DXA from CASEPER
coffee <- read.csv("./COFFEE-EGFRVsMGFR_DATA_2022-02-25_1841.csv")
coffee_dxa <- read.csv("./CASPER-BaselineCOFFEEDXAs_DATA_2022-02-25_1837.csv")
# get coffee IDs for merging with other COFFEE data
link <-  read.csv("./coffee casper link.csv")
link$subject_id <- link$ID.CASPER
coffee_dxa <- merge(coffee_dxa,link,by="subject_id",all.x = T, all.y = T)
coffee_dxa <- coffee_dxa %>% select(!(c(subject_id,ID.CASPER)))
coffee_dxa$subject_id <- coffee_dxa$ID.COFFEE
coffee_dxa <- coffee_dxa %>% select(!(ID.COFFEE))
coffee <- merge(coffee,coffee_dxa,by="subject_id",all.x = T,all.y = T)
coffee$gfr <- coffee$gfr_abs
coffee$gfr_abs <- NULL
coffee$age <- coffee$age_current
coffee$age_current <- NULL
coffee$sex_MF <- ifelse(coffee$gender==1,"M",
                           ifelse(!is.na(coffee$gender),"F",NA))
coffee$gender <- NULL
# did anyone check more than one race/ethnicity category 
coffee$race_sum <- rowSums(coffee[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)

# RENAL-HEIR
renal_heir <- read.csv("./RENALHEIR-EGFRVsMGFR_DATA_2022-02-25_1841.csv")
renal_heir$age <- renal_heir$age_current
renal_heir$age_current <- NULL
renal_heir$sex_MF <- ifelse(renal_heir$gender==1,"M",
                           ifelse(!is.na(renal_heir$gender),"F",NA))
renal_heir$gender <- NULL
# did anyone check more than one race/ethnicity category - yes, 4 people
renal_heir$race_sum <- rowSums(renal_heir[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)

# IMPROVE
improve <- read.csv("./IMPROVET2D-EGFRVsMGFR_DATA_2022-02-25_1842.csv")
improve$age <- improve$age_current
improve$age_current <- NULL
improve$sex_MF <- ifelse(improve$gender==1,"M",
                           ifelse(!is.na(improve$gender),"F",NA))
improve$gender <- NULL
# did anyone check more than one race/ethnicity category - yes, 1 person
improve$race_sum <- rowSums(improve[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)

# PGN
# for now, we'll exclude PGN, since GFR measures haven't been received yet
pgn <- read.csv("./PENGUIN-EGFRVsMGFR_DATA_2022-02-25_1843.csv")
pgn$gfr <- as.numeric(pgn$gfr)
pgn$age <- pgn$age_consent
pgn$age_consent <- NULL
pgn$sex_MF <- ifelse(pgn$sex==2,"M",
                           ifelse(!is.na(pgn$sex),"F",NA))
pgn$sex <- NULL
# did anyone check more than one race/ethnicity category
pgn$race_sum <- rowSums(pgn[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)
pgn$clamp_weight <- pgn$clamp_wt
pgn$clamp_wt <- NULL
pgn$clamp_height <- pgn$clamp_ht
pgn$clamp_ht <- NULL

# BMT
bmt <- read.csv("./177844RenalBloodFlow-EGFRVsMGFR_DATA_2022-02-25_1843.csv")
bmt$gfr <- bmt$igfr_ab
bmt$igfr_ab <- NULL
bmt$sex_MF <- ifelse(bmt$sex==2,"M",
                           ifelse(!is.na(bmt$sex),"F",NA))
# did anyone check more than one race/ethnicity category
#bmt$race_sum <- rowSums(bmt[,c("race___1","race___2","race___3","race___4","race___5","race___6","race___7")],na.rm = T)
bmt$clamp_weight <- bmt$wt
bmt$wt <- NULL
bmt$clamp_height <- bmt$ht
bmt$ht <- NULL

# make sure all variables are named the same


```

# Background

# Methods

# Results

```{r echo=FALSE}
kable(t1,caption = "")
```

