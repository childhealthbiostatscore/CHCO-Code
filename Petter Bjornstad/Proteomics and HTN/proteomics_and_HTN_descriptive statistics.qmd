---
title: "Proteomics and HTN - descriptive statistics"
author: "Laura Pyle, Ye Ji Choi & Tim Vigers"
date: "today"
date-format: long
format:
  html:
    toc: true
    toc-depth: 5
    toc-float: true
    code-fold: true
    self-contained: true
    fig-cap-location: top
    page-layout: full
editor: source
execute:
  echo: false
  message: false
---

```{r libraries}
#| include: false
library(psych)
library(corrplot)
library(pander)
library(dplyr)
library(gtsummary)
# Print all pander tables
panderOptions("knitr.auto.asis", FALSE)
```

```{r data import}
#| include: false
# source("~/GitHub/CHCO-Code/Petter Bjornstad/Proteomics and DKD/create_today_dkd_analysis_dataset.R")
load("/Volumes/Shared/Shared Projects/Laura/Peds Endo/Petter Bjornstad/Proteomics and HTN/Data_Cleaned/analysis_dataset.RData")
```

```{r, include=F}
t <- df %>% mutate(
  race_ethnicity_condensed = case_when(
    race == "White" & startsWith(ethnicity, "Not") ~ "Non-Hispanic White",
    race == "Black or African American" & startsWith(ethnicity, "Not") ~ "Non-Hispanic Black",
    ethnicity == "Hispanic or Latino" ~ "Hispanic",
    T ~ "Other"
  ),
  soma = case_when(!is.na(seq.10000.28) ~ "Yes", T ~ "No"),
  olink_plasma = case_when(record_id %in% plasma$record_id ~ "Yes", T ~ "No"),
  olink_urine = case_when(record_id %in% urine$record_id ~ "Yes", T ~ "No")
) %>% 
  select(
    group, age, sex, race_ethnicity_condensed, diabetes_duration, hba1c, bmi, acr_u, sbp, dbp, map,
    eGFR_fas_cr, gfr_bsa_plasma, gfr_raw_plasma, elevated_albuminuria, htn, soma, olink_plasma, olink_urine
  ) %>% 
  tbl_summary(by = group,
              statistic = list(all_continuous() ~ "{mean} ({sd})",
                          acr_u ~ "{median} [{p25}, {p75}]",
                          missing_text = "Missing"
                               ))

```

```{r}
t
```

