---
title: "Pima Trajectory Analysis"
author: "Tim Vigers & Laura Pyle"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include=FALSE}
library(readxl)
library(knitr)
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
home_dir = ifelse(.Platform$OS.type != "unix",
                  "C:/Users/timvigers/Dropbox/Work/Pima/",
                  "~/UCD/PEDS/RI Biostatistics Core/Shared/Shared Projects/Laura/BDC/Projects/")
knitr::opts_knit$set(root.dir = home_dir)
```

```{r import}
combined = read_excel("Combined Kidney Data.xls")
```

# 1. Check that DOB is the same across visits for everyone

```{r}
dob = combined %>% group_by(NIH) %>% summarize(n_dobs = length(unique(DOB)))
multiples = unique(dob$NIH[which(dob$n_dobs != 1)])
if(length(multiples) > 0){
  combined %>% filter(NIH %in% multiples) %>% group_by(NIH) %>% 
    count(DOB,PROTOCOL) %>% select(-n) %>% kable()
}
```

There were `r length(multiples)` participants with multiple DOB values.

# 2. Check that date of diagnosis is the same across visits for everyone

```{r}
dx = combined %>% group_by(NIH) %>% summarize(n_dx_dates = length(unique(DATE_DX)))
multiples = unique(dx$NIH[which(dx$n_dx_dates != 1)])
if(length(multiples) > 0){
  combined %>% filter(NIH %in% multiples) %>% group_by(NIH) %>% 
    count(DATE_DX,PROTOCOL) %>% select(-n) %>% kable()
}
```

There were `r length(multiples)` participants with multiple date of diagnosis values.

# 3. Check that sex is the same across visits for everyone

```{r}
sex = combined %>% group_by(NIH) %>% summarize(n_sex = length(unique(SEX)))
multiples = unique(sex$NIH[which(sex$n_sex != 1)])
if(length(multiples) > 0){
  combined %>% filter(NIH %in% multiples) %>% group_by(NIH) %>% 
    count(DATE_DX,PROTOCOL) %>% select(-n) %>% kable()
}
```

There were `r length(multiples)` participants with multiple sex values.
